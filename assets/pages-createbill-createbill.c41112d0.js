import{q as e,g as i,v as s,y as t,B as a,C as l,s as r,o,c as d,w as m,a as u,h as n,t as f,f as p,D as c}from"./index-de2112c1.js";import{_ as h}from"./uni-easyinput.78c90da9.js";import{_ as y,r as b}from"./uni-app.es.f5d8e4b4.js";import{_ as q,a as g}from"./uni-forms.d99627c8.js";import{_ as j}from"./uni-card.a08da529.js";import{l as _}from"./lodash.78ef8cd2.js";import{q as B}from"./qs.f1a07ed8.js";import{v as V}from"./v4.ba5d26a9.js";import"./uni-icons.c5d1a199.js";const k=y({data:()=>({form:{title:"",description:"",id:V(),datetime:"",lastModifiedTime:""},query:e()[e().length-1].$page.options,rules:{title:{rules:[{required:!0,errorMessage:"账本名称不能为空"}]}}}),methods:{submit(){this.$refs.form.validate().then((()=>{this.query.id?this.updateBill():this.createBill()}))},createBill(){let e=i("bills")||[];this.form.datetime=new Date,this.form.lastModifiedTime=new Date,e.unshift(this.form),s("bills",e),t({title:"创建成功",mask:!0}),setTimeout((()=>{a({url:`/pages/detail/detail?${B(this.form)}`})}),1500)},updateBill(e){let a=i("bills")||[];const r=a.find((({id:e})=>e===this.query.id));this.form.lastModifiedTime=new Date,_.assign(r,this.form),s("bills",a),t({title:"更新成功",mask:!0}),setTimeout((()=>{l()}),1500)},fetchBill(){const e=(i("bills")||[]).find((({id:e})=>e===this.query.id));_.assign(this.form,e)}},onLoad(){this.query.id&&(this.fetchBill(),r({title:"编辑账本"}))}},[["render",function(e,i,s,t,a,l){const r=b(p("uni-easyinput"),h),y=b(p("uni-forms-item"),q),_=c,B=b(p("uni-forms"),g),V=b(p("uni-card"),j);return o(),d(V,{"is-full":"",border:!1,padding:"0",spacing:"0",class:"br-8 shadow"},{default:m((()=>[u(B,{rules:a.rules,ref:"form",model:a.form,"label-position":"top",class:"container"},{default:m((()=>[u(y,{label:"账本名称",name:"title",required:""},{default:m((()=>[u(r,{modelValue:a.form.title,"onUpdate:modelValue":i[0]||(i[0]=e=>a.form.title=e),placeholder:"为账本起一个名吧"},null,8,["modelValue"])])),_:1}),u(y,{label:"备注"},{default:m((()=>[u(r,{modelValue:a.form.description,"onUpdate:modelValue":i[1]||(i[1]=e=>a.form.description=e),placeholder:"是否需要在该账本写些备注...",type:"textarea"},null,8,["modelValue"])])),_:1}),u(_,{type:"primary",size:"middle",onClick:l.submit,class:"my-20"},{default:m((()=>[n(f(a.query.id?"更新账本":"创建账本"),1)])),_:1},8,["onClick"])])),_:1},8,["rules","model"])])),_:1})}]]);export{k as default};
